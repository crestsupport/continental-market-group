<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Real Estate Stress Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #333;
            text-align: center;
        }
        .form-group {
            margin-bottom: 1em;
        }
        label {
            display: block;
            margin-bottom: 0.5em;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 0.5em;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        input:disabled, select:disabled {
            background-color: #e0e0e0;
            cursor: not-allowed;
        }
        button {
            width: 100%;
            padding: 0.75em;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
        }
        button:disabled {
            background-color: #aaa;
            cursor: not-allowed;
        }
        button:hover:not(:disabled) {
            background-color: #0056b3;
        }
        .section, #result, .disclaimer {
            margin-top: 1.5em;
            padding: 1em;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #fff;
        }
        #payment-section {
            display: none;
        }
        #result {
            display: none;
        }
        .error {
            color: red;
            font-size: 0.875em;
            margin-top: 0.5em;
        }
        .footer {
            text-align: center;
            margin-top: 1.5em;
            font-size: 0.75em;
            color: #666;
        }
        .payment-link {
            text-align: center;
            margin: 1em 0;
        }
        .payment-link a {
            display: inline-block;
            padding: 0.75em 1.5em;
            background-color: #007BFF;
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }
        .payment-link a:hover {
            background-color: #0056b3;
        }
        canvas {
            border: 1px solid #ccc;
            margin-top: 0.5em;
            display: block;
            width: 100%;
            height: 200px;
        }
        #downloadBtn {
            margin-top: 1em;
            background-color: #333;
            color: white;
            padding: 0.75em;
            text-align: center;
            display: inline-block;
            border-radius: 4px;
            text-decoration: none;
            width: 100%;
            box-sizing: border-box;
        }
        #downloadBtn:hover {
            background-color: #555;
        }
        .draggable {
            width: 100px;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            text-align: center;
            border-radius: 4px;
            cursor: move;
            user-select: none;
            margin: 10px 0;
        }
        .drop-zone {
            border: 2px dashed #ccc;
            padding: 20px;
            text-align: center;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin-top: 10px;
        }
        .drop-zone.active {
            border-color: #007BFF;
            background-color: #e0f0ff;
        }
        .price-highlight {
            font-size: 1.2em;
            font-weight: bold;
            color: #d32f2f;
            background-color: #fff9c4;
            padding: 2px 6px;
            border-radius: 3px;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            animation: pulse 1.5s infinite;
        }
        s {
            color: #666;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <h1>Canadian Real Estate Stress Tester</h1>
    <div class="section">
        <h2>About Us</h2>
        <p>We are a data-driven platform powered by AI and machine learning, dedicated to providing impartial real estate assessment tools. Operated by Continental Market Group, our approach is rooted in impartiality, allowing the latest 2025 data and potential policy impacts to speak for themselves. We analyze market trends, government policies, and economic factors to deliver clear, objective insights into your propertyâ€™s future.</p>
    <h3>Ready to Stress Test Your Property?</h3>
<p>Pay <span class="price-highlight">$19.99 CAD</span> (regular price: <s>$39.99 CAD</s>, limited time offer) via Stripe to unlock your assessment results.</p>
<div id="payment">
    <button id="checkout-button">Buy Now ($19.99)</button>
</div>
<script src="https://js.stripe.com/v3/"></script>
<script>
    let isPaid = false;
    let hasGeoLocation = false;
    let useGeoLocation = false;

    function toggleGeoLocation() {
        useGeoLocation = document.getElementById('useGeoLocation').checked;
        const geoSection = document.getElementById('geoLocationSection');
        geoSection.style.display = useGeoLocation ? 'block' : 'none';
        toggleFormFields();
    }

    function toggleFormFields() {
        const fields = ['appraisalPrice', 'bedrooms', 'bathrooms', 'squareFootage', 'province', 'city', 'condition', 'submitBtn'];
        fields.forEach(field => {
            const element = document.getElementById(field);
            element.disabled = !isPaid || (useGeoLocation && !hasGeoLocation);
        });
    }

    // Initialize Stripe with your publishable key
    const stripe = Stripe('pk_test_your_key_here'); // Replace with your actual Stripe publishable key

    const checkoutButton = document.getElementById('checkout-button');
    checkoutButton.addEventListener('click', async () => {
        try {
            const response = await fetch('https://stripe-backend-gold.vercel.app/create-checkout-session', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
            });
            const { id } = await response.json();
            const { error } = await stripe.redirectToCheckout({ sessionId: id });
            if (error) {
                console.error('Error:', error);
            } else {
                isPaid = true; // Temporary; update with success verification later
                toggleFormFields();
            }
        } catch (error) {
            console.error('Fetch error:', error);
        }
    });

    function simulatePayment() {
        isPaid = true;
        toggleFormFields();
    }

    toggleGeoLocation(); // Initial call
</script>
<p><button type="button" onclick="simulatePayment()">Simulate Payment (For Demo)</button></p>
<div class="section">
    <h3>Geo-Location Setup</h3>
    <div class="form-group">
        <label>
            <input type="checkbox" id="useGeoLocation" onchange="toggleGeoLocation()">
            Include geo-location in my assessment
        </label>
    </div>
    <div id="geoLocationSection" style="display: none;">
        <div id="geoLocationDraggable" class="draggable" draggable="true">Geo-Location</div>
        <div id="geoLocationDropZone" class="drop-zone">Drop Geo-Location Here</div>
        <div class="form-group">
            <label for="geoLocation">Geo-Location (Latitude, Longitude):</label>
            <input type="text" id="geoLocation" name="geoLocation" placeholder="e.g., 43.6532, -79.3832" readonly>
            <div class="error" id="geoLocationError"></div>
        </div>
        <canvas id="mapCanvas" width="400" height="200" aria-label="Interactive map for setting property location"></canvas>
    </div>
</div>
<p>Pay <span class="price-highlight">$19.99 CAD</span> (regular price: <s>$39.99 CAD</s>, limited time offer) via Stripe to unlock your assessment results.</p>
<div id="payment">
    <button id="checkout-button">Buy Now ($19.99)</button>
</div>
<script src="https://js.stripe.com/v3/"></script>
<script>
    let isPaid = false;
    let hasGeoLocation = false;
    let useGeoLocation = false;

    function toggleGeoLocation() {
        useGeoLocation = document.getElementById('useGeoLocation').checked;
        const geoSection = document.getElementById('geoLocationSection');
        geoSection.style.display = useGeoLocation ? 'block' : 'none';
        toggleFormFields();
    }

    function toggleFormFields() {
        const fields = ['appraisalPrice', 'bedrooms', 'bathrooms', 'squareFootage', 'province', 'city', 'condition', 'submitBtn'];
        fields.forEach(field => {
            const element = document.getElementById(field);
            element.disabled = !isPaid || (useGeoLocation && !hasGeoLocation);
        });
    }

    // Initialize Stripe with your publishable key
    const stripe = Stripe('pk_test_your_key_here'); // Replace with your actual Stripe publishable key

    const checkoutButton = document.getElementById('checkout-button');
    checkoutButton.addEventListener('click', async () => {
        try {
            const response = await fetch('https://stripe-backend-gold.vercel.app/create-checkout-session', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
            });
            const { id } = await response.json();
            const { error } = await stripe.redirectToCheckout({ sessionId: id });
            if (error) {
                console.error('Error:', error);
            } else {
                isPaid = true; // Temporary; update with success verification later
                toggleFormFields();
            }
        } catch (error) {
            console.error('Fetch error:', error);
        }
    });

    function simulatePayment() {
        isPaid = true;
        toggleFormFields();
    }

    toggleGeoLocation(); // Initial call
</script>
<p><button type="button" onclick="simulatePayment()">Simulate Payment (For Demo)</button></p>
<div class="section">
    <h3>Geo-Location Setup</h3>
    <div class="form-group">
        <label>
            <input type="checkbox" id="useGeoLocation" onchange="toggleGeoLocation()">
            Include geo-location in my assessment
        </label>
    
            <input type="checkbox" id="useGeoLocation" onchange="toggleGeoLocation()">
            Include geo-location in my assessment
        </label>
    
            });
            const { id } = await response.json();
            const { error } = await stripe.redirectToCheckout({ sessionId: id });
            if (error) {
                console.error('Error:', error);
            } else {
              

    
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
            });
            const { id } = await response.json();

            // Redirect to Stripe Checkout
            const { error } = await stripe.redirectToCheckout({ sessionId: id });
            if (error) {
                console.error(error);
            }
        });
    </script>
    <p><button type="button" onclick="simulatePayment()">Simulate Payment (For Demo)</button></p>
</div>
        <h3>Ready to Stress Test Your Property?</h3>
        <p>Pay <span class="price-highlight">$19.99 CAD</span> (regular price: <s>$39.99 CAD</s>, limited time offer) via Stripe to unlock your assessment results.</p>
        <p><a href="https://buy.stripe.com/eVqcMN4Ke6PYbtC8w3a7C02" target="_blank" id="stripeLink">Buy Now with Stripe</a></p>
        <p><button type="button" onclick="simulatePayment()">Simulate Payment (For Demo)</button></p>
    </div>
    <form id="stressTestForm">
        
            <label for="squareFootage">Square Footage:</label>
            <input type="number" id="squareFootage" name="squareFootage" disabled required>
            <div class="error" id="squareFootageError"></div>
        </div>
        <div class="form-group">
            <label for="province">Province:</label>
            <select id="province" name="province" disabled required>
                <option value="">Select Province</option>
                <option value="AB">Alberta</option>
                <option value="BC">British Columbia</option>
                <option value="MB">Manitoba</option>
                <option value="NB">New Brunswick</option>
                <option value="NL">Newfoundland and Labrador</option>
                <option value="NS">Nova Scotia</option>
                <option value="ON">Ontario</option>
              
            <select id="condition" name="condition" disabled required>
                <option value="0-5">0â€“5 years</option>
                <option value="5-15">5â€“15 years</option>
                <option value="15-30">15â€“30 years</option>
                <option value="30+">30+ years</option>
            </select>
            <div class="error" id="conditionError"></div>
        </div>
        <button type="submit" id="submitBtn" disabled>Calculate Stress Test</button>
    </form>
    <div id="result"></div>
    <div class="disclaimer">
        <p><strong>Disclaimer:</strong> This tool provides estimates based on 2025 public data for informational purposes only. It is not financial, legal, or real estate advice. Results may not reflect real-time market conditions, and we are not liable for decisions based on this tool. Consult a professional for personalized advice.</p>
    </div>
    <div class="footer">
        <p><a href="./privacy-policy">Privacy Policy</a> | <a href="./terms-of-use">Terms of Use</a> | <a href="mailto:catalystcg@outlook.com">Contact Us</a> | Â© 2025 Continental Market Group. All rights reserved.</p>
    </div>

    <script>
        let isPaid = false;
        let hasGeoLocation = false;
        let useGeoLocation = false;

        function toggleGeoLocation() {
            useGeoLocation = document.getElementById('useGeoLocation').checked;
            const geoSection
