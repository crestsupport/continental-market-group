<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Real Estate Stress Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #333;
            text-align: center;
        }
        .form-group {
            margin-bottom: 1em;
        }
        label {
            display: block;
            margin-bottom: 0.5em;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 0.5em;
            border: 2px solid #FF0000; /* Canadian red border */
            border-radius: 4px;
            box-sizing: border-box;
        }
        input:disabled, select:disabled {
            background-color: #e0e0e0;
            cursor: not-allowed;
        }
        button, .payment-link a {
            width: 100%;
            padding: 0.75em;
            background-color: #FF0000; /* Canadian red button */
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        button:disabled, .payment-link a:disabled {
            background-color: #aaa;
            cursor: not-allowed;
        }
        button:hover:not(:disabled), .payment-link a:hover:not(:disabled) {
            background-color: #CC0000; /* Darker Canadian red */
        }
        .section, #result, .disclaimer {
            margin-top: 1.5em;
            padding: 1em;
            border: 2px solid #FF0000; /* Canadian red border */
            border-radius: 4px;
            background-color: #fff;
        }
        #payment-section {
            display: none;
        }
        #result {
            display: none;
        }
        .error {
            color: red;
            font-size: 0.875em;
            margin-top: 0.5em;
        }
        .footer {
            text-align: center;
            margin-top: 1.5em;
            font-size: 0.75em;
            color: #666;
            border-top: 2px solid #FF0000; /* Canadian red top border */
        }
        .payment-link {
            text-align: center;
            margin: 1em 0;
        }
        canvas {
            border: 2px solid #FF0000; /* Canadian red border */
            margin-top: 0.5em;
            display: block;
            width: 100%;
            height: 200px;
        }
        #downloadBtn {
            margin-top: 1em;
            background-color: #333;
            color: white;
            padding: 0.75em;
            text-align: center;
            display: inline-block;
            border-radius: 4px;
            text-decoration: none;
            width: 100%;
            box-sizing: border-box;
        }
        #downloadBtn:hover {
            background-color: #555;
        }
        .draggable {
            width: 100px;
            padding: 10px;
            background-color: #FF0000; /* Canadian red */
            color: white;
            text-align: center;
            border-radius: 4px;
            cursor: move;
            user-select: none;
            margin: 10px 0;
        }
        .drop-zone {
            border: 2px dashed #FF0000; /* Canadian red dashed border */
            padding: 20px;
            text-align: center;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin-top: 10px;
        }
        .drop-zone.active {
            border-color: #CC0000; /* Darker Canadian red */
            background-color: #e0f0ff;
        }
        .price-highlight {
            font-size: 1.2em;
            font-weight: bold;
            color: #d32f2f;
            background-color: #fff9c4;
            padding: 2px 6px;
            border-radius: 3px;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            animation: pulse 1.5s infinite;
        }
        s {
            color: #666;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .flag {
            font-size: 1.5em;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <h1>Canadian Real Estate Stress Tester ðŸ‡¨ðŸ‡¦</h1>
    <div class="section">
        <h2>About Us</h2>
        <p>We are a data-driven platform powered by AI and machine learning, dedicated to providing impartial real estate assessment tools across Canada. Operated by Continental Market Group, our approach is rooted in impartiality, leveraging the latest 2025 Canadian data and potential policy impacts to deliver clear, objective insights into your propertyâ€™s future.</p>
        <h3>Ready to Stress Test Your Canadian Property?</h3>
        <p>Pay <span class="price-highlight">$19.99 CAD</span> (regular price: <s>$39.99 CAD</s>, limited time offer) via Stripe to unlock your assessment results.</p>
        <div id="payment">
            <a href="https://buy.stripe.com/eVqcMN4Ke6PYbtC8u3a7C02" id="checkout-button" class="payment-link">Buy Now ($19.99)</a>
        </div>
        <script>
            let isPaid = false;
            let hasGeoLocation = false;
            let useGeoLocation = false;

            function toggleGeoLocation() {
                useGeoLocation = document.getElementById('useGeoLocation').checked;
                const geoSection = document.getElementById('geoLocationSection');
                geoSection.style.display = useGeoLocation ? 'block' : 'none';
                toggleFormFields();
                console.log('Geo toggle updated, useGeoLocation:', useGeoLocation);
            }

            function toggleFormFields() {
                const fields = ['appraisalPrice', 'bedrooms', 'bathrooms', 'squareFootage', 'location', 'geoLocation', 'submitBtn'];
                console.log('Toggling fields, isPaid:', isPaid, 'useGeoLocation:', useGeoLocation, 'hasGeoLocation:', hasGeoLocation);
                fields.forEach(field => {
                    const element = document.getElementById(field);
                    if (element) {
                        element.disabled = !isPaid || (useGeoLocation && !hasGeoLocation);
                        console.log(`Field ${field} disabled: ${element.disabled}`);
                    } else {
                        console.log(`Element ${field} not found`);
                    }
                });
            }

            // Check if payment was successful from the success URL
            window.addEventListener('load', () => {
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('session_id')) {
                    isPaid = true;
                    console.log('Payment successful, isPaid set to:', isPaid);
                    toggleFormFields();
                    alert('Payment confirmed. Form is now enabled.');
                }
            });

            function simulatePayment() {
                isPaid = true;
                console.log('Simulate payment triggered, isPaid set to:', isPaid);
                toggleFormFields();
                alert('Payment simulated. Form is now enabled for demo purposes.');
            }

            function assessProperty(event) {
                event.preventDefault();
                if (!isPaid) {
                    alert('Please complete payment to unlock assessment.');
                    return;
                }

                const appraisalPrice = parseFloat(document.getElementById('appraisalPrice').value);
                const bedrooms = parseInt(document.getElementById('bedrooms').value);
                const bathrooms = parseInt(document.getElementById('bathrooms').value);
                const squareFootage = parseInt(document.getElementById('squareFootage').value);
                const location = document.getElementById('location').value;
                const geoLocation = document.getElementById('geoLocation').value;

                // Simulated 2025-2027 market data with policy adjustments
                const basePricePerSqFt = 500; // 2025 Ontario average
                const growthRate = 0.02; // Adjusted to 2% due to tariff and policy uncertainty
                const interestRateImpact = location.includes('Toronto') ? 0.01 : 0.005; // Lower rates boost demand
                const locationFactor = location.includes('Toronto') ? 1.2 : 1.0; // Toronto premium
                const roomFactor = (bedrooms + bathrooms * 0.5) / 10; // Weight rooms
                const currentPricePerSqFt = basePricePerSqFt * locationFactor * (1 + roomFactor) * (1 - interestRateImpact);
                const futurePricePerSqFt = currentPricePerSqFt * Math.pow(1 + growthRate, 2); // 2-year projection

                // Calculate current and projected values
                const currentValue = appraisalPrice;
                const projectedValue = squareFootage * futurePricePerSqFt;
                const percentageChange = ((projectedValue - currentValue) / currentValue) * 100;

                // Draw simple map (placeholder)
                const ctx = document.getElementById('mapCanvas').getContext('2d');
                ctx.clearRect(0, 0, 400, 200);
                ctx.fillStyle = '#FF0000'; // Canadian red map marker
                ctx.fillRect(50, 50, 100, 100); // Static marker

                // 2-year outlook with policy considerations
                let outlook;
                if (percentageChange > 3) {
                    outlook = `Expected value increase of ${percentageChange.toFixed(1)}% over 2 years, supported by lower interest rates and Canadian housing initiatives, though tempered by tariff risks.`;
                } else if (percentageChange < -3) {
                    outlook = `Potential value decrease of ${(-percentageChange).toFixed(1)}% over 2 years, influenced by trade uncertainty and policy constraints.`;
                } else {
                    outlook = `Value expected to remain stable (Â±3%) over 2 years, balancing interest rate cuts and potential budget impacts.`;
                }

                document.getElementById('result').style.display = 'block';
                document.getElementById('result').innerHTML = `
                    <p>Current Value: $${currentValue.toLocaleString()}</p>
                    <p>Projected Value (2 Years): $${projectedValue.toLocaleString()}</p>
                    <p>2-Year Outlook: ${outlook}</p>
                    <p>Location: ${location} (Geo: ${geoLocation})</p>
                `;
            }

            toggleGeoLocation();
            // Temporary override to enable fields for testing (remove later)
            document.querySelectorAll('select, input, button').forEach(el => el.disabled = false);
        </script>
        <p><button type="button" id="simulatePayment" onclick="simulatePayment()">Simulate Payment (For Demo)</button></p>
    </div>
    <div class="section">
        <h3>Geo-Location Setup</h3>
        <div class="form-group">
            <label>
                <input type="checkbox" id="useGeoLocation" onchange="toggleGeoLocation()">
                Include geo-location in my assessment
            </label>
        </div>
        <div id="geoLocationSection" style="display: none;">
            <div id="geoLocationDraggable" class="draggable" draggable="true">Geo-Location</div>
            <div id="geoLocationDropZone" class="drop-zone">Drop Geo-Location Here</div>
            <div class="form-group">
                <label for="geoLocation">Geo-Location (Latitude, Longitude):</label>
                <input type="text" id="geoLocation" name="geoLocation" placeholder="e.g., 43.6532, -79.3832" readonly>
                <div class="error" id="geoLocationError"></div>
            </div>
            <canvas id="mapCanvas" width="400" height="200" aria-label="Interactive map for setting property location"></canvas>
        </div>
    </div>
    <form id="stressTestForm" onsubmit="assessProperty(event)">
        <div class="form-group">
            <label for="appraisalPrice">Estimated Appraisal Price ($CAD):</label>
            <input type="number" id="appraisalPrice" name="appraisalPrice" min="0" disabled required>
            <div class="error" id="appraisalPriceError"></div>
        </div>
        <div class="form-group">
            <label for="bedrooms">Number of Bedrooms:</label>
            <input type="number" id="bedrooms" name="bedrooms" min="0" disabled required>
            <div class="error" id="bedroomsError"></div>
        </div>
        <div class="form-group">
            <label for="bathrooms">Number of Bathrooms:</label>
            <input type="number" id="bathrooms" name="bathrooms" min="0" disabled required>
            <div class="error" id="bathroomsError"></div>
        </div>
        <div class="form-group">
            <label for="squareFootage">Square Footage:</label>
            <input type="number" id="squareFootage" name="squareFootage" min="0" disabled required>
            <div class="error" id="squareFootageError"></div>
        </div>
        <div class="form-group">
            <label for="location">City/Neighborhood:</label>
            <input type="text" id="location" name="location" disabled required>
            <div class="error" id="locationError"></div>
        </div>
        <button type="submit" id="submitBtn" disabled>Calculate 2-Year Outlook</button>
    </form>
    <div id="result"></div>
    <div class="disclaimer">
        <p><strong>Disclaimer:</strong> This tool provides estimates based on 2025 Canadian public data for informational purposes only. It is not financial, legal, or real estate advice. Results may not reflect real-time market conditions, and we are not liable for decisions based on this tool. Consult a professional for personalized advice.</p>
    </div>
    <div class="footer">
        <p><a href="./privacy-policy.html">Privacy Policy</a> | <a href="./terms-of-use.html">Terms of Use</a> | <a href="mailto:catalystcg@outlook.com">Contact Us</a> | Â© 2025 Continental Market Group. All rights reserved. ðŸ‡¨ðŸ‡¦</p>
    </div>
</body>
</html>
