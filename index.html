<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate Stress Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f9;
            color: #333;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }
        nav {
            background-color: #2c3e50;
            padding: 1rem;
            width: 100%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            z-index: 1000;
        }
        nav a {
            color: #ecf0f1;
            margin: 0 1.5rem;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        nav a:hover {
            color: #3498db;
        }
        .content {
            max-width: 600px;
            margin: 6rem auto 2rem;
            padding: 2rem;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin: 1.5rem 0;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }
        input, select, button {
            width: 100%;
            padding: 0.75rem;
            margin: 0.25rem 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        button {
            background-color: #3498db;
            color: #fff;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        #postalCodeError, #appraisalPriceError, #emailError {
            color: #e74c3c;
            margin-top: 0.5rem;
        }
        .section {
            display: none;
        }
        .active {
            display: block;
        }
        .results {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #dff0d8;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <nav>
        <a href="#" onclick="event.preventDefault(); showSection('stress-test');">Stress Test</a>
        <a href="#" onclick="event.preventDefault(); showSection('about-us');">About Us</a>
        <a href="#" onclick="event.preventDefault(); showSection('privacy-terms');">Privacy & Terms</a>
    </nav>
    <div class="content">
        <div id="stress-test" class="section active">
            <h2>Real Estate Stress Test</h2>
            <form id="stressTestForm">
                <div class="form-group">
                    <label for="email">Email <span style="color: #e74c3c;">*</span></label>
                    <input type="email" id="email" name="email" placeholder="Enter your email" required>
                    <label for="postalCode">Postal Code</label>
                    <input type="text" id="postalCode" name="postalCode" placeholder="e.g., M5V 2T6" required>
                    <label for="appraisalPrice">Appraisal Price ($)</label>
                    <input type="number" id="appraisalPrice" name="appraisalPrice" placeholder="e.g., 500000" required>
                    <label for="propertyCategory">Property Type</label>
                    <select id="propertyCategory" name="propertyCategory" required>
                        <option value="">Select Property Type</option>
                        <option value="Condo">Condo</option>
                        <option value="House">House</option>
                        <option value="Townhouse">Townhouse</option>
                        <option value="Apartment">Apartment</option>
                        <option value="Duplex">Duplex</option>
                    </select>
                    <label for="province">Province</label>
                    <select id="province" name="province" required>
                        <option value="">Select Province</option>
                        <option value="Ontario">Ontario</option>
                        <option value="British Columbia">British Columbia</option>
                        <option value="Alberta">Alberta</option>
                        <option value="Quebec">Quebec</option>
                        <option value="Manitoba">Manitoba</option>
                        <option value="Saskatchewan">Saskatchewan</option>
                        <option value="Nova Scotia">Nova Scotia</option>
                        <option value="New Brunswick">New Brunswick</option>
                        <option value="Newfoundland and Labrador">Newfoundland and Labrador</option>
                        <option value="Prince Edward Island">Prince Edward Island</option>
                        <option value="Northwest Territories">Northwest Territories</option>
                        <option value="Yukon">Yukon</option>
                        <option value="Nunavut">Nunavut</option>
                    </select>
                    <label for="bedrooms">Bedrooms</label>
                    <input type="number" id="bedrooms" name="bedrooms" placeholder="e.g., 2" required>
                    <label for="bathrooms">Bathrooms</label>
                    <input type="number" id="bathrooms" name="bathrooms" placeholder="e.g., 1.5" required>
                    <label for="squareFootage">Square Footage</label>
                    <input type="number" id="squareFootage" name="squareFootage" placeholder="e.g., 1200" required>
                    <label for="location">Location</label>
                    <input type="text" id="location" name="location" placeholder="e.g., Downtown Toronto" required>
                    <button type="submit">Proceed to Payment</button>
                </div>
                <div id="postalCodeError"></div>
                <div id="appraisalPriceError"></div>
                <div id="emailError"></div>
            </form>
            <div id="results" class="results">
                <h3>Your Stress Test Results</h3>
                <p id="resultText"></p>
            </div>
        </div>
        <div id="about-us" class="section">
            <h2>About Us</h2>
            <p>We are a dedicated team of real estate analysts and technologists committed to revolutionizing property value assessment. Unlike traditional property appraisals, which provide a static snapshot, our Real Estate Stress Test delivers a dynamic 24-month outlook, incorporating current market trends, economic indicators, and regional data. With over a decade of experience in the Canadian real estate market, we empower property owners and investors with actionable insights to navigate future uncertainties. Our mission is to simplify complex market dynamics through a user-friendly platform, supporting your financial planning with forward-looking analysis.</p>
        </div>
        <div id="privacy-terms" class="section">
            <h2>Privacy & Terms</h2>
            <h3>Privacy Policy</h3>
            <p>Your privacy is our top priority. When you utilize our Real Estate Stress Test, we collect your email address and property specifications exclusively to generate and deliver your personalized 24-month outlook results. This data is safeguarded with stringent security measures and is not shared with third parties, sold, or utilized for marketing purposes without your explicit consent. We retain your information only for the duration necessary to process your request and fulfill our service obligations, after which it is securely deleted unless retention is required by applicable law or regulation. By submitting your information, you consent to our data handling practices as outlined herein. For any privacy-related inquiries or to exercise your rights, please contact us through our designated support channel. We are committed to complying with all relevant privacy laws, including Canada’s Personal Information Protection and Electronic Documents Act (PIPEDA).</p>
            <h3>Terms of Use</h3>
            <p>This Real Estate Stress Test service is provided on an "as is" and "as available" basis for informational purposes only and does not constitute financial, legal, or investment advice. To receive your detailed 24-month outlook, a one-time payment of $19.99 CAD is required, reflecting our limited-time offer (regular price: $39.99 CAD). The projections and analyses generated by this tool are estimates based on historical data, current market conditions, and predictive models, and we make no warranties regarding their accuracy or reliability. Catalyst Consulting Group and its affiliates are not liable for any direct, indirect, incidental, or consequential damages, including but not limited to financial losses, resulting from your use of this service or reliance on its outputs. Use of this platform constitutes your acceptance of these terms. We reserve the right to modify these terms of use, adjust pricing, or discontinue the service at our discretion, with reasonable notice provided to users where feasible. All disputes arising from or related to this service shall be governed by the laws of the Province of Ontario and the federal laws of Canada applicable therein, with exclusive jurisdiction vested in the courts of Ontario. If any provision of these terms is found to be unenforceable, the remaining provisions shall remain in full effect.</p>
        </div>
    </div>
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('stressTestForm');
            const resultsDiv = document.getElementById('results');
            const resultText = document.getElementById('resultText');

            if (form) {
                form.style.display = 'block';

                form.onsubmit = function(event) {
                    event.preventDefault();
                    const formData = {
                        email: document.getElementById('email').value,
                        postalCode: document.getElementById('postalCode').value,
                        appraisalPrice: document.getElementById('appraisalPrice').value,
                        propertyCategory: document.getElementById('propertyCategory').value,
                        province: document.getElementById('province').value,
                        bedrooms: document.getElementById('bedrooms').value,
                        bathrooms: document.getElementById('bathrooms').value,
                        squareFootage: document.getElementById('squareFootage').value,
                        location: document.getElementById('location').value
                    };
                    if (!formData.email) {
                        document.getElementById('emailError').textContent = 'Email is required to receive results.';
                        return;
                    }
                    if (!formData.postalCode.match(/[A-Za-z]\d[A-Za-z]\s?\d[A-Za-z]\d/)) {
                        document.getElementById('postalCodeError').textContent = 'Please enter a valid Canadian postal code (e.g., M5V 2T6).';
                        return;
                    }
                    if (!formData.appraisalPrice || formData.appraisalPrice <= 0 || !formData.squareFootage || formData.squareFootage <= 0) {
                        document.getElementById('appraisalPriceError').textContent = 'Please enter positive numbers for appraisal price and square footage.';
                        return;
                    }

                    // Generate a unique ID for tracking
                    const uniqueId = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                        const r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                        return v.toString(16);
                    });

                    // Store form data with unique ID
                    localStorage.setItem(uniqueId, JSON.stringify(formData));

                    // Redirect to Stripe Checkout with success URL
                    const stripeUrl = `https://buy.stripe.com/eVqcMN4Ke6PYbtC8u3a7C02?prefilled_email=${encodeURIComponent(formData.email)}&client_reference_id=${uniqueId}&success_url=${encodeURIComponent(window.location.href + '?session_id={CHECKOUT_SESSION_ID}')}&cancel_url=${encodeURIComponent(window.location.href)}`;
                    window.location.href = stripeUrl;
                };
            }

            // Simulate success page behavior
            const urlParams = new URLSearchParams(window.location.search);
            const sessionId = urlParams.get('session_id');
            if (sessionId) {
                const uniqueId = localStorage.getItem('client_reference_id') || sessionId; // Simulate matching
                const formData = JSON.parse(localStorage.getItem(uniqueId));
                if (formData) {
                    // Simulate payment confirmation and calculate results
                    const marketData = {
                        nationalTrends: { priceChangeAnnual: -0.015, salesDrop: 0.03, unsoldInventory: 0.05, basePrice: 679 },
                        policyImpact: { interestRate: 0.0275, economicUncertainty: 0.02 },
                        weights: { priceChange: 0.4, salesDrop: 0.3, unsoldInventory: 0.2, policyImpact: 0.1 },
                        postalCodeFactors: { 'M5V': 0.995, 'V6B': 0.99, 'H3B': 1.00, 'T2P': 0.98, 'B3J': 0.97, 'L0A': 0.99 }
                    };
                    const postalCodePrefix = formData.postalCode.toUpperCase().replace(/\s/g, '').slice(0, 3);
                    const postalFactor = marketData.postalCodeFactors[postalCodePrefix] || 1.0;
                    const nationalData = marketData.nationalTrends;
                    const sentimentScore = (nationalData.priceChangeAnnual * marketData.weights.priceChange) +
                                          (nationalData.salesDrop * marketData.weights.salesDrop * -1) +
                                          (nationalData.unsoldInventory * marketData.weights.unsoldInventory * -1) +
                                          (marketData.policyImpact.economicUncertainty * marketData.weights.policyImpact * -1);
                    const adjustedGrowthRate = Math.max(Math.min(sentimentScore * 0.5, 0.02), -0.02);
                    const currentValue = parseFloat(formData.appraisalPrice);
                    const projectedValue = currentValue * (1 + adjustedGrowthRate);
                    const percentageChange = ((projectedValue - currentValue) / currentValue) * 100;

                    let increaseChance, declineChance, outlook;
                    if (percentageChange < -2) {
                        declineChance = 60; increaseChance = 40;
                        outlook = `Expected value decrease of ${(-percentageChange).toFixed(1)}% over 2 years due to market conditions.`;
                    } else if (percentageChange > 2) {
                        increaseChance = 60; declineChance = 40;
                        outlook = `Expected value increase of ${percentageChange.toFixed(1)}% over 2 years, though tempered by risks.`;
                    } else {
                        increaseChance = 50; declineChance = 50;
                        outlook = `Value expected to remain stable (±2%) over 2 years, reflecting current market trends.`;
                    }

                    const result = `
                        Email: ${formData.email}
                        Current Value: $${currentValue.toLocaleString()}
                        Projected Value (2 Years): $${projectedValue.toLocaleString()}
                        2-Year Outlook: ${outlook}
                        Price Movement Probability: ${increaseChance}% chance of increase, ${declineChance}% chance of decline
                        Location: ${formData.location} (Postal Code: ${formData.postalCode})
                        Property Type: ${formData.propertyCategory}
                        Province: ${formData.province}
                        Please save these results for your records.
                    `;
                    resultText.textContent = result;
                    resultsDiv.style.display = 'block';
                    localStorage.removeItem(uniqueId); // Clean up
                }
            }
        });
    </script>
</body>
</html>
